"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/feishu/data/route";
exports.ids = ["app/api/feishu/data/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeishu%2Fdata%2Froute&page=%2Fapi%2Ffeishu%2Fdata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeishu%2Fdata%2Froute.ts&appDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeishu%2Fdata%2Froute&page=%2Fapi%2Ffeishu%2Fdata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeishu%2Fdata%2Froute.ts&appDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_123_Desktop_hongfu_app_api_feishu_data_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/feishu/data/route.ts */ \"(rsc)/./app/api/feishu/data/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/feishu/data/route\",\n        pathname: \"/api/feishu/data\",\n        filename: \"route\",\n        bundlePath: \"app/api/feishu/data/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\123\\\\Desktop\\\\hongfu\\\\app\\\\api\\\\feishu\\\\data\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_123_Desktop_hongfu_app_api_feishu_data_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/feishu/data/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZmZWlzaHUlMkZkYXRhJTJGcm91dGUmcGFnZT0lMkZhcGklMkZmZWlzaHUlMkZkYXRhJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGZmVpc2h1JTJGZGF0YSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUMxMjMlNUNEZXNrdG9wJTVDaG9uZ2Z1JTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUMxMjMlNUNEZXNrdG9wJTVDaG9uZ2Z1JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNpQjtBQUM5RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2ZlaXNodS1iaXRhYmxlLWFwcC8/ZjFjMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFwxMjNcXFxcRGVza3RvcFxcXFxob25nZnVcXFxcYXBwXFxcXGFwaVxcXFxmZWlzaHVcXFxcZGF0YVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvZmVpc2h1L2RhdGEvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9mZWlzaHUvZGF0YVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZmVpc2h1L2RhdGEvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFwxMjNcXFxcRGVza3RvcFxcXFxob25nZnVcXFxcYXBwXFxcXGFwaVxcXFxmZWlzaHVcXFxcZGF0YVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvZmVpc2h1L2RhdGEvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeishu%2Fdata%2Froute&page=%2Fapi%2Ffeishu%2Fdata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeishu%2Fdata%2Froute.ts&appDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/feishu/data/route.ts":
/*!**************************************!*\
  !*** ./app/api/feishu/data/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _app_services_feishu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/app/services/feishu */ \"(rsc)/./app/services/feishu.ts\");\n\n\n// 获取安全状态类型\nconst getSafetyStatusType = (statusText)=>{\n    if (statusText.includes(\"安全\")) {\n        return \"safe\";\n    } else if (statusText.includes(\"危险\")) {\n        return \"danger\";\n    } else if (statusText.includes(\"生命危险\")) {\n        return \"emergency\";\n    }\n    return \"safe\";\n};\n// 处理表格数据，转换为楼栋-楼层-房号的结构\nconst processTableData = (records)=>{\n    // 简化的数据处理，直接使用对象结构\n    const result = {};\n    // 遍历所有记录，按楼栋-楼层-房号分组\n    for (const record of records){\n        const { 楼栋号, 楼层, 房号 } = record.fields;\n        // 初始化楼栋\n        if (!result[楼栋号]) {\n            result[楼栋号] = {};\n        }\n        // 初始化楼层\n        if (!result[楼栋号][楼层]) {\n            result[楼栋号][楼层] = {};\n        }\n        // 初始化房号记录数组\n        if (!result[楼栋号][楼层][房号]) {\n            result[楼栋号][楼层][房号] = [];\n        }\n        // 添加记录\n        result[楼栋号][楼层][房号].push(record);\n    }\n    // 对每个房号的记录按时间排序，并设置安全状态\n    for(const building in result){\n        for(const floor in result[building]){\n            for(const room in result[building][floor]){\n                const roomRecords = result[building][floor][room];\n                // 按时间从晚到早排序\n                roomRecords.sort((a, b)=>b.fields.提交时间 - a.fields.提交时间);\n                // 获取最新记录的安全状态\n                const latestStatus = roomRecords[0].fields.安全状态;\n                const statusType = getSafetyStatusType(latestStatus);\n                // 设置最终的单元格状态\n                result[building][floor][room] = {\n                    status: statusType,\n                    records: roomRecords\n                };\n            }\n        }\n    }\n    return result;\n};\n// 添加CORS头部\nconst corsHeaders = {\n    \"Access-Control-Allow-Origin\": \"*\",\n    \"Access-Control-Allow-Methods\": \"GET, POST, PUT, DELETE, OPTIONS\",\n    \"Access-Control-Allow-Headers\": \"Content-Type, Authorization\",\n    \"Access-Control-Max-Age\": \"86400\"\n};\n// OPTIONS请求处理（预检请求）\nasync function OPTIONS() {\n    return new Response(null, {\n        status: 200,\n        headers: corsHeaders\n    });\n}\n// GET请求处理\nasync function GET() {\n    try {\n        // 从飞书API获取表格数据\n        const tableData = await _app_services_feishu__WEBPACK_IMPORTED_MODULE_1__.feishuService.getTableRecords();\n        const records = tableData.items;\n        // 处理表格数据，转换为楼栋-楼层-房号的结构\n        const processedData = processTableData(records);\n        // 获取所有楼栋名称\n        const buildings = Object.keys(processedData).sort();\n        // 计算统计数据\n        let totalRecords = 0;\n        for(const building in processedData){\n            for(const floor in processedData[building]){\n                for(const room in processedData[building][floor]){\n                    totalRecords += processedData[building][floor][room].records.length;\n                }\n            }\n        }\n        const result = {\n            success: true,\n            data: {\n                buildings,\n                buildingData: processedData,\n                stats: {\n                    totalRecords,\n                    lastUpdateTime: Date.now()\n                }\n            }\n        };\n        // 设置适当的缓存头，减少客户端请求频率\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result, {\n            headers: {\n                ...corsHeaders,\n                \"Cache-Control\": \"no-store, max-age=0\"\n            }\n        });\n    } catch (error) {\n        console.error(\"Error fetching data from Feishu API:\", error);\n        // 在错误情况下返回之前的数据或空数据结构，避免前端频繁重试\n        const errorResponse = {\n            success: false,\n            message: error instanceof Error ? error.message : \"Unknown error\",\n            data: {\n                buildings: [],\n                buildingData: {},\n                stats: {\n                    totalRecords: 0,\n                    lastUpdateTime: Date.now()\n                }\n            }\n        };\n        // 在错误情况下也设置缓存头，避免客户端立即重试\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(errorResponse, {\n            headers: {\n                ...corsHeaders,\n                \"Cache-Control\": \"no-cache, no-store, must-revalidate\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dXRlLnRzP2RkZWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xyXG5pbXBvcnQgeyBmZWlzaHVTZXJ2aWNlIH0gZnJvbSAnQC9hcHAvc2VydmljZXMvZmVpc2h1JztcclxuaW1wb3J0IHsgQnVpbGRpbmdEYXRhLCBTYWZldHlTdGF0dXMsIFRhYmxlUmVjb3JkIH0gZnJvbSAnQC9hcHAvdHlwZXMnO1xyXG5cclxuLy8g6I635Y+W5a6J5YWo54q25oCB57G75Z6LXHJcbmNvbnN0IGdldFNhZmV0eVN0YXR1c1R5cGUgPSAoc3RhdHVzVGV4dDogc3RyaW5nKTogU2FmZXR5U3RhdHVzID0+IHtcclxuICBpZiAoc3RhdHVzVGV4dC5pbmNsdWRlcygn5a6J5YWoJykpIHtcclxuICAgIHJldHVybiAnc2FmZSc7XHJcbiAgfSBlbHNlIGlmIChzdGF0dXNUZXh0LmluY2x1ZGVzKCfljbHpmaknKSkge1xyXG4gICAgcmV0dXJuICdkYW5nZXInO1xyXG4gIH0gZWxzZSBpZiAoc3RhdHVzVGV4dC5pbmNsdWRlcygn55Sf5ZG95Y2x6ZmpJykpIHtcclxuICAgIHJldHVybiAnZW1lcmdlbmN5JztcclxuICB9XHJcbiAgcmV0dXJuICdzYWZlJztcclxufTtcclxuXHJcbi8vIOWkhOeQhuihqOagvOaVsOaNru+8jOi9rOaNouS4uualvOagiy3mpbzlsYIt5oi/5Y+355qE57uT5p6EXHJcbmNvbnN0IHByb2Nlc3NUYWJsZURhdGEgPSAocmVjb3JkczogVGFibGVSZWNvcmRbXSkgPT4ge1xyXG4gIC8vIOeugOWMlueahOaVsOaNruWkhOeQhu+8jOebtOaOpeS9v+eUqOWvueixoee7k+aehFxyXG4gIGNvbnN0IHJlc3VsdDogYW55ID0ge307XHJcblxyXG4gIC8vIOmBjeWOhuaJgOacieiusOW9le+8jOaMiealvOagiy3mpbzlsYIt5oi/5Y+35YiG57uEXHJcbiAgZm9yIChjb25zdCByZWNvcmQgb2YgcmVjb3Jkcykge1xyXG4gICAgY29uc3QgeyDmpbzmoIvlj7csIOalvOWxgiwg5oi/5Y+3IH0gPSByZWNvcmQuZmllbGRzO1xyXG4gICAgXHJcbiAgICAvLyDliJ3lp4vljJbmpbzmoItcclxuICAgIGlmICghcmVzdWx0W+alvOagi+WPt10pIHtcclxuICAgICAgcmVzdWx0W+alvOagi+WPt10gPSB7fTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g5Yid5aeL5YyW5qW85bGCXHJcbiAgICBpZiAoIXJlc3VsdFvmpbzmoIvlj7ddW+alvOWxgl0pIHtcclxuICAgICAgcmVzdWx0W+alvOagi+WPt11b5qW85bGCXSA9IHt9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDliJ3lp4vljJbmiL/lj7forrDlvZXmlbDnu4RcclxuICAgIGlmICghcmVzdWx0W+alvOagi+WPt11b5qW85bGCXVvmiL/lj7ddKSB7XHJcbiAgICAgIHJlc3VsdFvmpbzmoIvlj7ddW+alvOWxgl1b5oi/5Y+3XSA9IFtdO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyDmt7vliqDorrDlvZVcclxuICAgIHJlc3VsdFvmpbzmoIvlj7ddW+alvOWxgl1b5oi/5Y+3XS5wdXNoKHJlY29yZCk7XHJcbiAgfVxyXG5cclxuICAvLyDlr7nmr4/kuKrmiL/lj7fnmoTorrDlvZXmjInml7bpl7TmjpLluo/vvIzlubborr7nva7lronlhajnirbmgIFcclxuICBmb3IgKGNvbnN0IGJ1aWxkaW5nIGluIHJlc3VsdCkge1xyXG4gICAgZm9yIChjb25zdCBmbG9vciBpbiByZXN1bHRbYnVpbGRpbmddKSB7XHJcbiAgICAgIGZvciAoY29uc3Qgcm9vbSBpbiByZXN1bHRbYnVpbGRpbmddW2Zsb29yXSkge1xyXG4gICAgICAgIGNvbnN0IHJvb21SZWNvcmRzID0gcmVzdWx0W2J1aWxkaW5nXVtmbG9vcl1bcm9vbV07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8g5oyJ5pe26Ze05LuO5pma5Yiw5pep5o6S5bqPXHJcbiAgICAgICAgcm9vbVJlY29yZHMuc29ydCgoYTogVGFibGVSZWNvcmQsIGI6IFRhYmxlUmVjb3JkKSA9PiBiLmZpZWxkcy7mj5DkuqTml7bpl7QgLSBhLmZpZWxkcy7mj5DkuqTml7bpl7QpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIOiOt+WPluacgOaWsOiusOW9leeahOWuieWFqOeKtuaAgVxyXG4gICAgICAgIGNvbnN0IGxhdGVzdFN0YXR1cyA9IHJvb21SZWNvcmRzWzBdLmZpZWxkcy7lronlhajnirbmgIE7XHJcbiAgICAgICAgY29uc3Qgc3RhdHVzVHlwZSA9IGdldFNhZmV0eVN0YXR1c1R5cGUobGF0ZXN0U3RhdHVzKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyDorr7nva7mnIDnu4jnmoTljZXlhYPmoLznirbmgIFcclxuICAgICAgICByZXN1bHRbYnVpbGRpbmddW2Zsb29yXVtyb29tXSA9IHtcclxuICAgICAgICAgIHN0YXR1czogc3RhdHVzVHlwZSxcclxuICAgICAgICAgIHJlY29yZHM6IHJvb21SZWNvcmRzLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHJlc3VsdCBhcyBCdWlsZGluZ0RhdGE7XHJcbn07XHJcblxyXG4vLyDmt7vliqBDT1JT5aS06YOoXHJcbmNvbnN0IGNvcnNIZWFkZXJzID0ge1xyXG4gICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKicsXHJcbiAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiAnR0VULCBQT1NULCBQVVQsIERFTEVURSwgT1BUSU9OUycsXHJcbiAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnOiAnQ29udGVudC1UeXBlLCBBdXRob3JpemF0aW9uJyxcclxuICAnQWNjZXNzLUNvbnRyb2wtTWF4LUFnZSc6ICc4NjQwMCcsIC8vIDI05bCP5pe2XHJcbn07XHJcblxyXG4vLyBPUFRJT05T6K+35rGC5aSE55CG77yI6aKE5qOA6K+35rGC77yJXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBPUFRJT05TKCkge1xyXG4gIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwge1xyXG4gICAgc3RhdHVzOiAyMDAsXHJcbiAgICBoZWFkZXJzOiBjb3JzSGVhZGVycyxcclxuICB9KTtcclxufVxyXG5cclxuLy8gR0VU6K+35rGC5aSE55CGXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XHJcbiAgdHJ5IHtcclxuICAgIC8vIOS7jumjnuS5pkFQSeiOt+WPluihqOagvOaVsOaNrlxyXG4gICAgY29uc3QgdGFibGVEYXRhID0gYXdhaXQgZmVpc2h1U2VydmljZS5nZXRUYWJsZVJlY29yZHMoKTtcclxuICAgIGNvbnN0IHJlY29yZHMgPSB0YWJsZURhdGEuaXRlbXM7XHJcbiAgICBcclxuICAgIC8vIOWkhOeQhuihqOagvOaVsOaNru+8jOi9rOaNouS4uualvOagiy3mpbzlsYIt5oi/5Y+355qE57uT5p6EXHJcbiAgICBjb25zdCBwcm9jZXNzZWREYXRhID0gcHJvY2Vzc1RhYmxlRGF0YShyZWNvcmRzKTtcclxuICAgIFxyXG4gICAgLy8g6I635Y+W5omA5pyJ5qW85qCL5ZCN56ewXHJcbiAgICBjb25zdCBidWlsZGluZ3MgPSBPYmplY3Qua2V5cyhwcm9jZXNzZWREYXRhKS5zb3J0KCk7XHJcbiAgICBcclxuICAgIC8vIOiuoeeul+e7n+iuoeaVsOaNrlxyXG4gICAgbGV0IHRvdGFsUmVjb3JkcyA9IDA7XHJcbiAgICBmb3IgKGNvbnN0IGJ1aWxkaW5nIGluIHByb2Nlc3NlZERhdGEpIHtcclxuICAgICAgZm9yIChjb25zdCBmbG9vciBpbiBwcm9jZXNzZWREYXRhW2J1aWxkaW5nXSkge1xyXG4gICAgICAgIGZvciAoY29uc3Qgcm9vbSBpbiBwcm9jZXNzZWREYXRhW2J1aWxkaW5nXVtmbG9vcl0pIHtcclxuICAgICAgICAgIHRvdGFsUmVjb3JkcyArPSBwcm9jZXNzZWREYXRhW2J1aWxkaW5nXVtmbG9vcl1bcm9vbV0ucmVjb3Jkcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IHJlc3VsdCA9IHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgZGF0YToge1xyXG4gICAgICAgIGJ1aWxkaW5ncyxcclxuICAgICAgICBidWlsZGluZ0RhdGE6IHByb2Nlc3NlZERhdGEsXHJcbiAgICAgICAgc3RhdHM6IHtcclxuICAgICAgICAgIHRvdGFsUmVjb3JkcyxcclxuICAgICAgICAgIGxhc3RVcGRhdGVUaW1lOiBEYXRlLm5vdygpLFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8g6K6+572u6YCC5b2T55qE57yT5a2Y5aS077yM5YeP5bCR5a6i5oi356uv6K+35rGC6aKR546HXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0LCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAuLi5jb3JzSGVhZGVycywgLy8g5re75YqgQ09SU+WktOmDqFxyXG4gICAgICAgICdDYWNoZS1Db250cm9sJzogJ25vLXN0b3JlLCBtYXgtYWdlPTAnLCAvLyDnpoHnlKjmtY/op4jlmajnvJPlrZjvvIzkvYblhYHorrhDRE7nvJPlrZhcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGRhdGEgZnJvbSBGZWlzaHUgQVBJOicsIGVycm9yKTtcclxuICAgIFxyXG4gICAgLy8g5Zyo6ZSZ6K+v5oOF5Ya15LiL6L+U5Zue5LmL5YmN55qE5pWw5o2u5oiW56m65pWw5o2u57uT5p6E77yM6YG/5YWN5YmN56uv6aKR57mB6YeN6K+VXHJcbiAgICBjb25zdCBlcnJvclJlc3BvbnNlID0ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgbWVzc2FnZTogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBidWlsZGluZ3M6IFtdLFxyXG4gICAgICAgIGJ1aWxkaW5nRGF0YToge30sXHJcbiAgICAgICAgc3RhdHM6IHtcclxuICAgICAgICAgIHRvdGFsUmVjb3JkczogMCxcclxuICAgICAgICAgIGxhc3RVcGRhdGVUaW1lOiBEYXRlLm5vdygpLFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8g5Zyo6ZSZ6K+v5oOF5Ya15LiL5Lmf6K6+572u57yT5a2Y5aS077yM6YG/5YWN5a6i5oi356uv56uL5Y2z6YeN6K+VXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZXJyb3JSZXNwb25zZSwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4uY29yc0hlYWRlcnMsIC8vIOa3u+WKoENPUlPlpLTpg6hcclxuICAgICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZSwgbm8tc3RvcmUsIG11c3QtcmV2YWxpZGF0ZScsXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJmZWlzaHVTZXJ2aWNlIiwiZ2V0U2FmZXR5U3RhdHVzVHlwZSIsInN0YXR1c1RleHQiLCJpbmNsdWRlcyIsInByb2Nlc3NUYWJsZURhdGEiLCJyZWNvcmRzIiwicmVzdWx0IiwicmVjb3JkIiwi5qW85qCL5Y+3Iiwi5qW85bGCIiwi5oi/5Y+3IiwiZmllbGRzIiwicHVzaCIsImJ1aWxkaW5nIiwiZmxvb3IiLCJyb29tIiwicm9vbVJlY29yZHMiLCJzb3J0IiwiYSIsImIiLCLmj5DkuqTml7bpl7QiLCJsYXRlc3RTdGF0dXMiLCLlronlhajnirbmgIEiLCJzdGF0dXNUeXBlIiwic3RhdHVzIiwiY29yc0hlYWRlcnMiLCJPUFRJT05TIiwiUmVzcG9uc2UiLCJoZWFkZXJzIiwiR0VUIiwidGFibGVEYXRhIiwiZ2V0VGFibGVSZWNvcmRzIiwiaXRlbXMiLCJwcm9jZXNzZWREYXRhIiwiYnVpbGRpbmdzIiwiT2JqZWN0Iiwia2V5cyIsInRvdGFsUmVjb3JkcyIsImxlbmd0aCIsInN1Y2Nlc3MiLCJkYXRhIiwiYnVpbGRpbmdEYXRhIiwic3RhdHMiLCJsYXN0VXBkYXRlVGltZSIsIkRhdGUiLCJub3ciLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwiZXJyb3JSZXNwb25zZSIsIm1lc3NhZ2UiLCJFcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/feishu/data/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/services/cache.ts":
/*!*******************************!*\
  !*** ./app/services/cache.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CacheService: () => (/* binding */ CacheService),\n/* harmony export */   cacheService: () => (/* binding */ cacheService)\n/* harmony export */ });\n// 缓存配置\nconst CACHE_CONFIG = {\n    // 新鲜缓存：60秒，减少API请求频率\n    FRESH_CACHE_DURATION: 60 * 1000,\n    // 旧数据缓存：10分钟，提供降级服务\n    STALE_CACHE_DURATION: 10 * 60 * 1000\n};\n// 缓存存储\nclass CacheService {\n    constructor(){\n        this.cache = new Map();\n    }\n    /**\r\n   * 设置缓存\r\n   * @param key 缓存键\r\n   * @param data 缓存数据\r\n   * @param isFresh 是否为新鲜缓存\r\n   */ set(key, data, isFresh = true) {\n        const now = Date.now();\n        const expire = now + (isFresh ? CACHE_CONFIG.FRESH_CACHE_DURATION : CACHE_CONFIG.STALE_CACHE_DURATION);\n        this.cache.set(key, {\n            data,\n            timestamp: now,\n            expire\n        });\n        console.log(`[CACHE] Set cache for ${key}, expire at ${new Date(expire).toISOString()}`);\n    }\n    /**\r\n   * 获取缓存\r\n   * @param key 缓存键\r\n   * @param allowStale 是否允许返回旧数据\r\n   * @returns 缓存数据或null\r\n   */ get(key, allowStale = false) {\n        const cacheItem = this.cache.get(key);\n        if (!cacheItem) {\n            console.log(`[CACHE] Miss cache for ${key}`);\n            return null;\n        }\n        const now = Date.now();\n        // 检查缓存是否完全过期\n        if (now > cacheItem.expire) {\n            this.cache.delete(key);\n            console.log(`[CACHE] Expired cache deleted for ${key}`);\n            return null;\n        }\n        // 检查缓存是否为旧数据且不允许返回旧数据\n        const isStale = now > cacheItem.timestamp + CACHE_CONFIG.FRESH_CACHE_DURATION;\n        if (isStale && !allowStale) {\n            console.log(`[CACHE] Stale cache for ${key}, but allowStale is false`);\n            return null;\n        }\n        console.log(`[CACHE] Hit cache for ${key}, ${isStale ? \"stale\" : \"fresh\"}`);\n        return cacheItem.data;\n    }\n    /**\r\n   * 删除缓存\r\n   * @param key 缓存键\r\n   */ delete(key) {\n        this.cache.delete(key);\n        console.log(`[CACHE] Delete cache for ${key}`);\n    }\n    /**\r\n   * 清空所有缓存\r\n   */ clear() {\n        this.cache.clear();\n        console.log(`[CACHE] Clear all cache`);\n    }\n}\n// 导出单例实例\nconst cacheService = new CacheService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvc2VydmljZXMvY2FjaGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFQSxPQUFPO0FBQ1AsTUFBTUEsZUFBZTtJQUNuQixxQkFBcUI7SUFDckJDLHNCQUFzQixLQUFLO0lBQzNCLG9CQUFvQjtJQUNwQkMsc0JBQXNCLEtBQUssS0FBSztBQUNsQztBQUVBLE9BQU87QUFDQSxNQUFNQztJQUdYQyxhQUFjO1FBQ1osSUFBSSxDQUFDQyxLQUFLLEdBQUcsSUFBSUM7SUFDbkI7SUFFQTs7Ozs7R0FLQyxHQUNEQyxJQUFPQyxHQUFXLEVBQUVDLElBQU8sRUFBRUMsVUFBbUIsSUFBSSxFQUFRO1FBQzFELE1BQU1DLE1BQU1DLEtBQUtELEdBQUc7UUFDcEIsTUFBTUUsU0FBU0YsTUFBT0QsQ0FBQUEsVUFBVVYsYUFBYUMsb0JBQW9CLEdBQUdELGFBQWFFLG9CQUFvQjtRQUVyRyxJQUFJLENBQUNHLEtBQUssQ0FBQ0UsR0FBRyxDQUFDQyxLQUFLO1lBQ2xCQztZQUNBSyxXQUFXSDtZQUNYRTtRQUNGO1FBRUFFLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHNCQUFzQixFQUFFUixJQUFJLFlBQVksRUFBRSxJQUFJSSxLQUFLQyxRQUFRSSxXQUFXLEdBQUcsQ0FBQztJQUN6RjtJQUVBOzs7OztHQUtDLEdBQ0RDLElBQU9WLEdBQVcsRUFBRVcsYUFBc0IsS0FBSyxFQUFZO1FBQ3pELE1BQU1DLFlBQVksSUFBSSxDQUFDZixLQUFLLENBQUNhLEdBQUcsQ0FBQ1Y7UUFDakMsSUFBSSxDQUFDWSxXQUFXO1lBQ2RMLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHVCQUF1QixFQUFFUixJQUFJLENBQUM7WUFDM0MsT0FBTztRQUNUO1FBRUEsTUFBTUcsTUFBTUMsS0FBS0QsR0FBRztRQUVwQixhQUFhO1FBQ2IsSUFBSUEsTUFBTVMsVUFBVVAsTUFBTSxFQUFFO1lBQzFCLElBQUksQ0FBQ1IsS0FBSyxDQUFDZ0IsTUFBTSxDQUFDYjtZQUNsQk8sUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUVSLElBQUksQ0FBQztZQUN0RCxPQUFPO1FBQ1Q7UUFFQSxzQkFBc0I7UUFDdEIsTUFBTWMsVUFBVVgsTUFBTVMsVUFBVU4sU0FBUyxHQUFHZCxhQUFhQyxvQkFBb0I7UUFDN0UsSUFBSXFCLFdBQVcsQ0FBQ0gsWUFBWTtZQUMxQkosUUFBUUMsR0FBRyxDQUFDLENBQUMsd0JBQXdCLEVBQUVSLElBQUkseUJBQXlCLENBQUM7WUFDckUsT0FBTztRQUNUO1FBRUFPLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHNCQUFzQixFQUFFUixJQUFJLEVBQUUsRUFBRWMsVUFBVSxVQUFVLFFBQVEsQ0FBQztRQUMxRSxPQUFPRixVQUFVWCxJQUFJO0lBQ3ZCO0lBRUE7OztHQUdDLEdBQ0RZLE9BQU9iLEdBQVcsRUFBUTtRQUN4QixJQUFJLENBQUNILEtBQUssQ0FBQ2dCLE1BQU0sQ0FBQ2I7UUFDbEJPLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHlCQUF5QixFQUFFUixJQUFJLENBQUM7SUFDL0M7SUFFQTs7R0FFQyxHQUNEZSxRQUFjO1FBQ1osSUFBSSxDQUFDbEIsS0FBSyxDQUFDa0IsS0FBSztRQUNoQlIsUUFBUUMsR0FBRyxDQUFDLENBQUMsdUJBQXVCLENBQUM7SUFDdkM7QUFDRjtBQUVBLFNBQVM7QUFDRixNQUFNUSxlQUFlLElBQUlyQixlQUFlIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmVpc2h1LWJpdGFibGUtYXBwLy4vYXBwL3NlcnZpY2VzL2NhY2hlLnRzPzU4OWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2FjaGVEYXRhIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLy8g57yT5a2Y6YWN572uXHJcbmNvbnN0IENBQ0hFX0NPTkZJRyA9IHtcclxuICAvLyDmlrDpspznvJPlrZjvvJo2MOenku+8jOWHj+WwkUFQSeivt+axgumikeeOh1xyXG4gIEZSRVNIX0NBQ0hFX0RVUkFUSU9OOiA2MCAqIDEwMDAsXHJcbiAgLy8g5pen5pWw5o2u57yT5a2Y77yaMTDliIbpkp/vvIzmj5DkvpvpmY3nuqfmnI3liqFcclxuICBTVEFMRV9DQUNIRV9EVVJBVElPTjogMTAgKiA2MCAqIDEwMDAsXHJcbn07XHJcblxyXG4vLyDnvJPlrZjlrZjlgqhcclxuZXhwb3J0IGNsYXNzIENhY2hlU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBjYWNoZTogTWFwPHN0cmluZywgQ2FjaGVEYXRhPGFueT4+O1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuY2FjaGUgPSBuZXcgTWFwKCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDorr7nva7nvJPlrZhcclxuICAgKiBAcGFyYW0ga2V5IOe8k+WtmOmUrlxyXG4gICAqIEBwYXJhbSBkYXRhIOe8k+WtmOaVsOaNrlxyXG4gICAqIEBwYXJhbSBpc0ZyZXNoIOaYr+WQpuS4uuaWsOmynOe8k+WtmFxyXG4gICAqL1xyXG4gIHNldDxUPihrZXk6IHN0cmluZywgZGF0YTogVCwgaXNGcmVzaDogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCBleHBpcmUgPSBub3cgKyAoaXNGcmVzaCA/IENBQ0hFX0NPTkZJRy5GUkVTSF9DQUNIRV9EVVJBVElPTiA6IENBQ0hFX0NPTkZJRy5TVEFMRV9DQUNIRV9EVVJBVElPTik7XHJcbiAgICBcclxuICAgIHRoaXMuY2FjaGUuc2V0KGtleSwge1xyXG4gICAgICBkYXRhLFxyXG4gICAgICB0aW1lc3RhbXA6IG5vdyxcclxuICAgICAgZXhwaXJlLFxyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUubG9nKGBbQ0FDSEVdIFNldCBjYWNoZSBmb3IgJHtrZXl9LCBleHBpcmUgYXQgJHtuZXcgRGF0ZShleHBpcmUpLnRvSVNPU3RyaW5nKCl9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bnvJPlrZhcclxuICAgKiBAcGFyYW0ga2V5IOe8k+WtmOmUrlxyXG4gICAqIEBwYXJhbSBhbGxvd1N0YWxlIOaYr+WQpuWFgeiuuOi/lOWbnuaXp+aVsOaNrlxyXG4gICAqIEByZXR1cm5zIOe8k+WtmOaVsOaNruaIlm51bGxcclxuICAgKi9cclxuICBnZXQ8VD4oa2V5OiBzdHJpbmcsIGFsbG93U3RhbGU6IGJvb2xlYW4gPSBmYWxzZSk6IFQgfCBudWxsIHtcclxuICAgIGNvbnN0IGNhY2hlSXRlbSA9IHRoaXMuY2FjaGUuZ2V0KGtleSk7XHJcbiAgICBpZiAoIWNhY2hlSXRlbSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgW0NBQ0hFXSBNaXNzIGNhY2hlIGZvciAke2tleX1gKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICAgIFxyXG4gICAgLy8g5qOA5p+l57yT5a2Y5piv5ZCm5a6M5YWo6L+H5pyfXHJcbiAgICBpZiAobm93ID4gY2FjaGVJdGVtLmV4cGlyZSkge1xyXG4gICAgICB0aGlzLmNhY2hlLmRlbGV0ZShrZXkpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgW0NBQ0hFXSBFeHBpcmVkIGNhY2hlIGRlbGV0ZWQgZm9yICR7a2V5fWApO1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvLyDmo4Dmn6XnvJPlrZjmmK/lkKbkuLrml6fmlbDmja7kuJTkuI3lhYHorrjov5Tlm57ml6fmlbDmja5cclxuICAgIGNvbnN0IGlzU3RhbGUgPSBub3cgPiBjYWNoZUl0ZW0udGltZXN0YW1wICsgQ0FDSEVfQ09ORklHLkZSRVNIX0NBQ0hFX0RVUkFUSU9OO1xyXG4gICAgaWYgKGlzU3RhbGUgJiYgIWFsbG93U3RhbGUpIHtcclxuICAgICAgY29uc29sZS5sb2coYFtDQUNIRV0gU3RhbGUgY2FjaGUgZm9yICR7a2V5fSwgYnV0IGFsbG93U3RhbGUgaXMgZmFsc2VgKTtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYFtDQUNIRV0gSGl0IGNhY2hlIGZvciAke2tleX0sICR7aXNTdGFsZSA/ICdzdGFsZScgOiAnZnJlc2gnfWApO1xyXG4gICAgcmV0dXJuIGNhY2hlSXRlbS5kYXRhIGFzIFQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliKDpmaTnvJPlrZhcclxuICAgKiBAcGFyYW0ga2V5IOe8k+WtmOmUrlxyXG4gICAqL1xyXG4gIGRlbGV0ZShrZXk6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgdGhpcy5jYWNoZS5kZWxldGUoa2V5KTtcclxuICAgIGNvbnNvbGUubG9nKGBbQ0FDSEVdIERlbGV0ZSBjYWNoZSBmb3IgJHtrZXl9YCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDmuIXnqbrmiYDmnInnvJPlrZhcclxuICAgKi9cclxuICBjbGVhcigpOiB2b2lkIHtcclxuICAgIHRoaXMuY2FjaGUuY2xlYXIoKTtcclxuICAgIGNvbnNvbGUubG9nKGBbQ0FDSEVdIENsZWFyIGFsbCBjYWNoZWApO1xyXG4gIH1cclxufVxyXG5cclxuLy8g5a+85Ye65Y2V5L6L5a6e5L6LXHJcbmV4cG9ydCBjb25zdCBjYWNoZVNlcnZpY2UgPSBuZXcgQ2FjaGVTZXJ2aWNlKCk7Il0sIm5hbWVzIjpbIkNBQ0hFX0NPTkZJRyIsIkZSRVNIX0NBQ0hFX0RVUkFUSU9OIiwiU1RBTEVfQ0FDSEVfRFVSQVRJT04iLCJDYWNoZVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImNhY2hlIiwiTWFwIiwic2V0Iiwia2V5IiwiZGF0YSIsImlzRnJlc2giLCJub3ciLCJEYXRlIiwiZXhwaXJlIiwidGltZXN0YW1wIiwiY29uc29sZSIsImxvZyIsInRvSVNPU3RyaW5nIiwiZ2V0IiwiYWxsb3dTdGFsZSIsImNhY2hlSXRlbSIsImRlbGV0ZSIsImlzU3RhbGUiLCJjbGVhciIsImNhY2hlU2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/services/cache.ts\n");

/***/ }),

/***/ "(rsc)/./app/services/feishu.ts":
/*!********************************!*\
  !*** ./app/services/feishu.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FeishuService: () => (/* binding */ FeishuService),\n/* harmony export */   feishuService: () => (/* binding */ feishuService)\n/* harmony export */ });\n/* harmony import */ var _cache__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./cache */ \"(rsc)/./app/services/cache.ts\");\n\n// 飞书API基础URL\nconst FEISHU_API_BASE_URL = \"https://open.feishu.cn/open-apis\";\n// 缓存键\nconst CACHE_KEYS = {\n    TENANT_ACCESS_TOKEN: \"feishu:tenant_access_token\",\n    TABLE_FIELDS: \"feishu:table_fields\",\n    TABLE_RECORDS: \"feishu:table_records\"\n};\n// 获取应用配置\nconst getAppConfig = ()=>{\n    return {\n        feishuAppId: process.env.FEISHU_APP_ID || \"\",\n        feishuAppSecret: process.env.FEISHU_APP_SECRET || \"\",\n        feishuAppToken: process.env.FEISHU_APP_TOKEN || \"\",\n        feishuTableId: process.env.FEISHU_TABLE_ID || \"\",\n        feishuViewId: process.env.FEISHU_VIEW_ID || \"\",\n        submitUrl: \"https://jcnw9wufsa17.feishu.cn/share/base/form/shrcn3WM0DXq7ytKKSiG9dGqzKc\" || 0\n    };\n};\n// 飞书API服务\nclass FeishuService {\n    constructor(){\n        // 添加请求节流机制\n        this.requestTimestamps = new Map();\n        this.MIN_REQUEST_INTERVAL = 5000 // 最小请求间隔5秒\n        ;\n        this.config = getAppConfig();\n    }\n    /**\r\n   * 获取Tenant Access Token\r\n   * @returns Tenant Access Token\r\n   */ async getTenantAccessToken() {\n        try {\n            // 检查是否可以发送请求（节流机制）\n            if (!this.canMakeRequest(\"getTenantAccessToken\")) {\n                console.log(\"[FEISHU] Skipping token request due to rate limiting\");\n                // 如果无法请求，尝试返回缓存的token，如果没有则抛出错误\n                const cachedToken = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TENANT_ACCESS_TOKEN);\n                if (cachedToken) {\n                    return cachedToken;\n                } else {\n                    throw new Error(\"Rate limited and no cached token available\");\n                }\n            }\n            // 尝试从缓存获取\n            const cachedToken = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TENANT_ACCESS_TOKEN);\n            if (cachedToken) {\n                return cachedToken;\n            }\n            console.log(\"[FEISHU] Fetching new tenant_access_token...\");\n            const startTime = Date.now();\n            const response = await fetch(`${FEISHU_API_BASE_URL}/auth/v3/tenant_access_token/internal`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    app_id: this.config.feishuAppId,\n                    app_secret: this.config.feishuAppSecret\n                })\n            });\n            const endTime = Date.now();\n            console.log(`[FEISHU] Fetch tenant_access_token completed in ${endTime - startTime}ms`);\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}, statusText: ${response.statusText}`);\n            }\n            const responseText = await response.text();\n            console.log(\"[FEISHU] Full response for tenant_access_token:\", responseText);\n            const data = JSON.parse(responseText);\n            if (data.code !== 0) {\n                throw new Error(`Failed to get tenant_access_token: ${data.msg}, code: ${data.code}`);\n            }\n            // 检查响应结构，飞书API可能直接在根级别返回token和expire\n            const tokenData = data.data || data;\n            if (!tokenData.tenant_access_token) {\n                throw new Error(`No tenant_access_token in response, full response: ${responseText}`);\n            }\n            // 缓存token，过期时间设置为响应的expire减去15分钟（900秒）的缓冲\n            const token = tokenData.tenant_access_token;\n            const expireInSeconds = Math.max(0, (tokenData.expire || 7200) - 900);\n            _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.set(CACHE_KEYS.TENANT_ACCESS_TOKEN, token, true);\n            return token;\n        } catch (error) {\n            console.error(\"[FEISHU] Error getting tenant access token:\", error);\n            // 如果获取新token失败，尝试返回缓存的token\n            const cachedToken = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TENANT_ACCESS_TOKEN);\n            if (cachedToken) {\n                console.log(\"[FEISHU] Using cached token after error\");\n                return cachedToken;\n            }\n            throw error;\n        }\n    }\n    /**\r\n   * 获取飞书表格字段\r\n   * @returns 表格字段列表\r\n   */ async getTableFields() {\n        try {\n            // 检查是否可以发送请求（节流机制）\n            if (!this.canMakeRequest(\"getTableFields\")) {\n                console.log(\"[FEISHU] Skipping table fields request due to rate limiting\");\n                // 如果无法请求，尝试返回缓存的字段，如果没有则抛出错误\n                const cachedFields = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TABLE_FIELDS, true);\n                if (cachedFields) {\n                    return cachedFields;\n                } else {\n                    throw new Error(\"Rate limited and no cached fields available\");\n                }\n            }\n            // 尝试从缓存获取\n            const cachedFields = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TABLE_FIELDS, true);\n            if (cachedFields) {\n                return cachedFields;\n            }\n            const token = await this.getTenantAccessToken();\n            console.log(\"[FEISHU] Fetching table fields...\");\n            const startTime = Date.now();\n            const response = await fetch(`${FEISHU_API_BASE_URL}/bitable/v1/apps/${this.config.feishuAppToken}/tables/${this.config.feishuTableId}/fields?view_id=${this.config.feishuViewId}`, {\n                method: \"GET\",\n                headers: {\n                    \"Authorization\": `Bearer ${token}`\n                },\n                // 禁用Next.js默认缓存\n                cache: \"no-store\"\n            });\n            const endTime = Date.now();\n            console.log(`[FEISHU] Fetch table fields completed in ${endTime - startTime}ms`);\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}, statusText: ${response.statusText}`);\n            }\n            const data = await response.json();\n            if (data.code !== 0) {\n                throw new Error(`Failed to get table fields: ${data.msg}`);\n            }\n            if (!data.data) {\n                throw new Error(\"No data in table fields response\");\n            }\n            // 设置缓存\n            _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.set(CACHE_KEYS.TABLE_FIELDS, data.data, true);\n            return data.data;\n        } catch (error) {\n            console.error(\"[FEISHU] Error getting table fields:\", error);\n            // 如果获取新数据失败，尝试返回缓存的数据\n            const cachedFields = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TABLE_FIELDS, true);\n            if (cachedFields) {\n                console.log(\"[FEISHU] Using cached fields after error\");\n                return cachedFields;\n            }\n            throw error;\n        }\n    }\n    /**\r\n   * 获取飞书表格记录\r\n   * @returns 表格记录列表\r\n   */ async getTableRecords() {\n        try {\n            // 检查是否可以发送请求（节流机制）\n            if (!this.canMakeRequest(\"getTableRecords\")) {\n                console.log(\"[FEISHU] Skipping table records request due to rate limiting\");\n                // 如果无法请求，尝试返回缓存的记录，如果没有则抛出错误\n                const cachedRecords = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TABLE_RECORDS, true);\n                if (cachedRecords) {\n                    return cachedRecords;\n                } else {\n                    throw new Error(\"Rate limited and no cached records available\");\n                }\n            }\n            // 尝试从缓存获取\n            const cachedRecords = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TABLE_RECORDS, true);\n            if (cachedRecords) {\n                return cachedRecords;\n            }\n            const token = await this.getTenantAccessToken();\n            console.log(\"[FEISHU] Fetching table records...\");\n            const startTime = Date.now();\n            const response = await fetch(`${FEISHU_API_BASE_URL}/bitable/v1/apps/${this.config.feishuAppToken}/tables/${this.config.feishuTableId}/records/search?page_size=500`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Authorization\": `Bearer ${token}`\n                },\n                body: JSON.stringify({\n                    view_id: this.config.feishuViewId\n                }),\n                // 禁用Next.js默认缓存\n                cache: \"no-store\"\n            });\n            const endTime = Date.now();\n            console.log(`[FEISHU] Fetch table records completed in ${endTime - startTime}ms`);\n            if (!response.ok) {\n                throw new Error(`HTTP error! status: ${response.status}, statusText: ${response.statusText}`);\n            }\n            const data = await response.json();\n            if (data.code !== 0) {\n                throw new Error(`Failed to get table records: ${data.msg}`);\n            }\n            if (!data.data) {\n                throw new Error(\"No data in table records response\");\n            }\n            // 设置缓存\n            _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.set(CACHE_KEYS.TABLE_RECORDS, data.data, true);\n            return data.data;\n        } catch (error) {\n            console.error(\"[FEISHU] Error getting table records:\", error);\n            // 如果获取新数据失败，尝试返回缓存的数据\n            const cachedRecords = _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.get(CACHE_KEYS.TABLE_RECORDS, true);\n            if (cachedRecords) {\n                console.log(\"[FEISHU] Using cached records after error\");\n                return cachedRecords;\n            }\n            throw error;\n        }\n    }\n    /**\r\n   * 检查是否可以发送请求（节流机制）\r\n   */ canMakeRequest(key) {\n        const now = Date.now();\n        const lastRequest = this.requestTimestamps.get(key) || 0;\n        const canRequest = now - lastRequest >= this.MIN_REQUEST_INTERVAL;\n        if (canRequest) {\n            this.requestTimestamps.set(key, now);\n        }\n        return canRequest;\n    }\n    /**\r\n   * 手动刷新缓存\r\n   */ async refreshCache() {\n        console.log(\"[FEISHU] Refreshing cache...\");\n        // 检查是否可以发送刷新请求\n        if (!this.canMakeRequest(\"refreshCache\")) {\n            console.log(\"[FEISHU] Skipping refresh due to rate limiting\");\n            return;\n        }\n        // 清除相关缓存\n        _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.delete(CACHE_KEYS.TABLE_FIELDS);\n        _cache__WEBPACK_IMPORTED_MODULE_0__.cacheService.delete(CACHE_KEYS.TABLE_RECORDS);\n        // 重新获取数据（异步，不等待完成）\n        this.getTableFields().catch((err)=>console.error(\"[FEISHU] Failed to refresh table fields:\", err));\n        this.getTableRecords().catch((err)=>console.error(\"[FEISHU] Failed to refresh table records:\", err));\n    }\n}\n// 导出单例实例\nconst feishuService = new FeishuService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFRO1FBQ3ZELE1BQU1FLGFBQWF0QyxNQUFNcUMsZUFBZSxJQUFJLENBQUNoRCxvQkFBb0I7UUFFakUsSUFBSWlELFlBQVk7WUFDZCxJQUFJLENBQUNuRCxpQkFBaUIsQ0FBQ3dDLEdBQUcsQ0FBQ1MsS0FBS3BDO1FBQ2xDO1FBRUEsT0FBT3NDO0lBQ1Q7SUFFQTs7R0FFQyxHQUNELE1BQU1DLGVBQThCO1FBQ2xDOUMsUUFBUUMsR0FBRyxDQUFDO1FBRVosZUFBZTtRQUNmLElBQUksQ0FBQyxJQUFJLENBQUNGLGNBQWMsQ0FBQyxpQkFBaUI7WUFDeENDLFFBQVFDLEdBQUcsQ0FBQztZQUNaO1FBQ0Y7UUFFQSxTQUFTO1FBQ1Q5QixnREFBWUEsQ0FBQzRFLE1BQU0sQ0FBQzFFLFdBQVdFLFlBQVk7UUFDM0NKLGdEQUFZQSxDQUFDNEUsTUFBTSxDQUFDMUUsV0FBV0csYUFBYTtRQUU1QyxtQkFBbUI7UUFDbkIsSUFBSSxDQUFDNEQsY0FBYyxHQUFHWSxLQUFLLENBQUNDLENBQUFBLE1BQU9qRCxRQUFRbUMsS0FBSyxDQUFDLDRDQUE0Q2M7UUFDN0YsSUFBSSxDQUFDVCxlQUFlLEdBQUdRLEtBQUssQ0FBQ0MsQ0FBQUEsTUFBT2pELFFBQVFtQyxLQUFLLENBQUMsNkNBQTZDYztJQUNqRztBQUNGO0FBRUEsU0FBUztBQUNGLE1BQU1DLGdCQUFnQixJQUFJMUQsZ0JBQWdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZmVpc2h1LWJpdGFibGUtYXBwLy4vYXBwL3NlcnZpY2VzL2ZlaXNodS50cz82YTllIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNhY2hlU2VydmljZSB9IGZyb20gJy4vY2FjaGUnO1xyXG5pbXBvcnQge1xyXG4gIEZlaXNodVJlc3BvbnNlLFxyXG4gIFRlbmFudEFjY2Vzc1Rva2VuUmVzcG9uc2UsXHJcbiAgVGFibGVGaWVsZHNSZXNwb25zZSxcclxuICBUYWJsZVJlY29yZHNSZXNwb25zZSxcclxuICBBcHBDb25maWcsXHJcbn0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLy8g6aOe5LmmQVBJ5Z+656GAVVJMXHJcbmNvbnN0IEZFSVNIVV9BUElfQkFTRV9VUkwgPSAnaHR0cHM6Ly9vcGVuLmZlaXNodS5jbi9vcGVuLWFwaXMnO1xyXG5cclxuLy8g57yT5a2Y6ZSuXHJcbmNvbnN0IENBQ0hFX0tFWVMgPSB7XHJcbiAgVEVOQU5UX0FDQ0VTU19UT0tFTjogJ2ZlaXNodTp0ZW5hbnRfYWNjZXNzX3Rva2VuJyxcclxuICBUQUJMRV9GSUVMRFM6ICdmZWlzaHU6dGFibGVfZmllbGRzJyxcclxuICBUQUJMRV9SRUNPUkRTOiAnZmVpc2h1OnRhYmxlX3JlY29yZHMnLFxyXG59O1xyXG5cclxuLy8g6I635Y+W5bqU55So6YWN572uXHJcbmNvbnN0IGdldEFwcENvbmZpZyA9ICgpOiBBcHBDb25maWcgPT4ge1xyXG4gIHJldHVybiB7XHJcbiAgICBmZWlzaHVBcHBJZDogcHJvY2Vzcy5lbnYuRkVJU0hVX0FQUF9JRCB8fCAnJyxcclxuICAgIGZlaXNodUFwcFNlY3JldDogcHJvY2Vzcy5lbnYuRkVJU0hVX0FQUF9TRUNSRVQgfHwgJycsXHJcbiAgICBmZWlzaHVBcHBUb2tlbjogcHJvY2Vzcy5lbnYuRkVJU0hVX0FQUF9UT0tFTiB8fCAnJyxcclxuICAgIGZlaXNodVRhYmxlSWQ6IHByb2Nlc3MuZW52LkZFSVNIVV9UQUJMRV9JRCB8fCAnJyxcclxuICAgIGZlaXNodVZpZXdJZDogcHJvY2Vzcy5lbnYuRkVJU0hVX1ZJRVdfSUQgfHwgJycsXHJcbiAgICBzdWJtaXRVcmw6IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVQk1JVF9VUkwgfHwgJycsXHJcbiAgfTtcclxufTtcclxuXHJcbi8vIOmjnuS5pkFQSeacjeWKoVxyXG5leHBvcnQgY2xhc3MgRmVpc2h1U2VydmljZSB7XHJcbiAgcHJpdmF0ZSBjb25maWc6IEFwcENvbmZpZztcclxuXHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLmNvbmZpZyA9IGdldEFwcENvbmZpZygpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+WVGVuYW50IEFjY2VzcyBUb2tlblxyXG4gICAqIEByZXR1cm5zIFRlbmFudCBBY2Nlc3MgVG9rZW5cclxuICAgKi9cclxuICBhc3luYyBnZXRUZW5hbnRBY2Nlc3NUb2tlbigpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8g5qOA5p+l5piv5ZCm5Y+v5Lul5Y+R6YCB6K+35rGC77yI6IqC5rWB5py65Yi277yJXHJcbiAgICAgIGlmICghdGhpcy5jYW5NYWtlUmVxdWVzdCgnZ2V0VGVuYW50QWNjZXNzVG9rZW4nKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbRkVJU0hVXSBTa2lwcGluZyB0b2tlbiByZXF1ZXN0IGR1ZSB0byByYXRlIGxpbWl0aW5nJyk7XHJcbiAgICAgICAgLy8g5aaC5p6c5peg5rOV6K+35rGC77yM5bCd6K+V6L+U5Zue57yT5a2Y55qEdG9rZW7vvIzlpoLmnpzmsqHmnInliJnmipvlh7rplJnor69cclxuICAgICAgICBjb25zdCBjYWNoZWRUb2tlbiA9IGNhY2hlU2VydmljZS5nZXQ8c3RyaW5nPihDQUNIRV9LRVlTLlRFTkFOVF9BQ0NFU1NfVE9LRU4pO1xyXG4gICAgICAgIGlmIChjYWNoZWRUb2tlbikge1xyXG4gICAgICAgICAgcmV0dXJuIGNhY2hlZFRva2VuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JhdGUgbGltaXRlZCBhbmQgbm8gY2FjaGVkIHRva2VuIGF2YWlsYWJsZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5bCd6K+V5LuO57yT5a2Y6I635Y+WXHJcbiAgICAgIGNvbnN0IGNhY2hlZFRva2VuID0gY2FjaGVTZXJ2aWNlLmdldDxzdHJpbmc+KENBQ0hFX0tFWVMuVEVOQU5UX0FDQ0VTU19UT0tFTik7XHJcbiAgICAgIGlmIChjYWNoZWRUb2tlbikge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWRUb2tlbjtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2coJ1tGRUlTSFVdIEZldGNoaW5nIG5ldyB0ZW5hbnRfYWNjZXNzX3Rva2VuLi4uJyk7XHJcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke0ZFSVNIVV9BUElfQkFTRV9VUkx9L2F1dGgvdjMvdGVuYW50X2FjY2Vzc190b2tlbi9pbnRlcm5hbGAsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgYXBwX2lkOiB0aGlzLmNvbmZpZy5mZWlzaHVBcHBJZCxcclxuICAgICAgICAgIGFwcF9zZWNyZXQ6IHRoaXMuY29uZmlnLmZlaXNodUFwcFNlY3JldCxcclxuICAgICAgICB9KSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBlbmRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgY29uc29sZS5sb2coYFtGRUlTSFVdIEZldGNoIHRlbmFudF9hY2Nlc3NfdG9rZW4gY29tcGxldGVkIGluICR7ZW5kVGltZSAtIHN0YXJ0VGltZX1tc2ApO1xyXG5cclxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c30sIHN0YXR1c1RleHQ6ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICBjb25zb2xlLmxvZygnW0ZFSVNIVV0gRnVsbCByZXNwb25zZSBmb3IgdGVuYW50X2FjY2Vzc190b2tlbjonLCByZXNwb25zZVRleHQpO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KTtcclxuICAgICAgXHJcbiAgICAgIGlmIChkYXRhLmNvZGUgIT09IDApIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgdGVuYW50X2FjY2Vzc190b2tlbjogJHtkYXRhLm1zZ30sIGNvZGU6ICR7ZGF0YS5jb2RlfWApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDmo4Dmn6Xlk43lupTnu5PmnoTvvIzpo57kuaZBUEnlj6/og73nm7TmjqXlnKjmoLnnuqfliKvov5Tlm550b2tlbuWSjGV4cGlyZVxyXG4gICAgICBjb25zdCB0b2tlbkRhdGEgPSBkYXRhLmRhdGEgfHwgZGF0YTtcclxuICAgICAgXHJcbiAgICAgIGlmICghdG9rZW5EYXRhLnRlbmFudF9hY2Nlc3NfdG9rZW4pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIHRlbmFudF9hY2Nlc3NfdG9rZW4gaW4gcmVzcG9uc2UsIGZ1bGwgcmVzcG9uc2U6ICR7cmVzcG9uc2VUZXh0fWApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyDnvJPlrZh0b2tlbu+8jOi/h+acn+aXtumXtOiuvue9ruS4uuWTjeW6lOeahGV4cGlyZeWHj+WOuzE15YiG6ZKf77yIOTAw56eS77yJ55qE57yT5YayXHJcbiAgICAgIGNvbnN0IHRva2VuID0gdG9rZW5EYXRhLnRlbmFudF9hY2Nlc3NfdG9rZW47XHJcbiAgICAgIGNvbnN0IGV4cGlyZUluU2Vjb25kcyA9IE1hdGgubWF4KDAsICh0b2tlbkRhdGEuZXhwaXJlIHx8IDcyMDApIC0gOTAwKTtcclxuICAgICAgXHJcbiAgICAgIGNhY2hlU2VydmljZS5zZXQoQ0FDSEVfS0VZUy5URU5BTlRfQUNDRVNTX1RPS0VOLCB0b2tlbiwgdHJ1ZSk7XHJcbiAgICAgIFxyXG4gICAgICByZXR1cm4gdG9rZW47XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdbRkVJU0hVXSBFcnJvciBnZXR0aW5nIHRlbmFudCBhY2Nlc3MgdG9rZW46JywgZXJyb3IpO1xyXG4gICAgICAvLyDlpoLmnpzojrflj5bmlrB0b2tlbuWksei0pe+8jOWwneivlei/lOWbnue8k+WtmOeahHRva2VuXHJcbiAgICAgIGNvbnN0IGNhY2hlZFRva2VuID0gY2FjaGVTZXJ2aWNlLmdldDxzdHJpbmc+KENBQ0hFX0tFWVMuVEVOQU5UX0FDQ0VTU19UT0tFTik7XHJcbiAgICAgIGlmIChjYWNoZWRUb2tlbikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdbRkVJU0hVXSBVc2luZyBjYWNoZWQgdG9rZW4gYWZ0ZXIgZXJyb3InKTtcclxuICAgICAgICByZXR1cm4gY2FjaGVkVG9rZW47XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDojrflj5bpo57kuabooajmoLzlrZfmrrVcclxuICAgKiBAcmV0dXJucyDooajmoLzlrZfmrrXliJfooahcclxuICAgKi9cclxuICBhc3luYyBnZXRUYWJsZUZpZWxkcygpOiBQcm9taXNlPFRhYmxlRmllbGRzUmVzcG9uc2U+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIOajgOafpeaYr+WQpuWPr+S7peWPkemAgeivt+axgu+8iOiKgua1geacuuWItu+8iVxyXG4gICAgICBpZiAoIXRoaXMuY2FuTWFrZVJlcXVlc3QoJ2dldFRhYmxlRmllbGRzJykpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnW0ZFSVNIVV0gU2tpcHBpbmcgdGFibGUgZmllbGRzIHJlcXVlc3QgZHVlIHRvIHJhdGUgbGltaXRpbmcnKTtcclxuICAgICAgICAvLyDlpoLmnpzml6Dms5Xor7fmsYLvvIzlsJ3or5Xov5Tlm57nvJPlrZjnmoTlrZfmrrXvvIzlpoLmnpzmsqHmnInliJnmipvlh7rplJnor69cclxuICAgICAgICBjb25zdCBjYWNoZWRGaWVsZHMgPSBjYWNoZVNlcnZpY2UuZ2V0PFRhYmxlRmllbGRzUmVzcG9uc2U+KENBQ0hFX0tFWVMuVEFCTEVfRklFTERTLCB0cnVlKTtcclxuICAgICAgICBpZiAoY2FjaGVkRmllbGRzKSB7XHJcbiAgICAgICAgICByZXR1cm4gY2FjaGVkRmllbGRzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JhdGUgbGltaXRlZCBhbmQgbm8gY2FjaGVkIGZpZWxkcyBhdmFpbGFibGUnKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOWwneivleS7jue8k+WtmOiOt+WPllxyXG4gICAgICBjb25zdCBjYWNoZWRGaWVsZHMgPSBjYWNoZVNlcnZpY2UuZ2V0PFRhYmxlRmllbGRzUmVzcG9uc2U+KENBQ0hFX0tFWVMuVEFCTEVfRklFTERTLCB0cnVlKTtcclxuICAgICAgaWYgKGNhY2hlZEZpZWxkcykge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWRGaWVsZHM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdGhpcy5nZXRUZW5hbnRBY2Nlc3NUb2tlbigpO1xyXG4gICAgICBcclxuICAgICAgY29uc29sZS5sb2coJ1tGRUlTSFVdIEZldGNoaW5nIHRhYmxlIGZpZWxkcy4uLicpO1xyXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG5cclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcclxuICAgICAgICBgJHtGRUlTSFVfQVBJX0JBU0VfVVJMfS9iaXRhYmxlL3YxL2FwcHMvJHt0aGlzLmNvbmZpZy5mZWlzaHVBcHBUb2tlbn0vdGFibGVzLyR7dGhpcy5jb25maWcuZmVpc2h1VGFibGVJZH0vZmllbGRzP3ZpZXdfaWQ9JHt0aGlzLmNvbmZpZy5mZWlzaHVWaWV3SWR9YCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbn1gLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIC8vIOemgeeUqE5leHQuanPpu5jorqTnvJPlrZhcclxuICAgICAgICAgIGNhY2hlOiAnbm8tc3RvcmUnLFxyXG4gICAgICAgIH1cclxuICAgICAgKTtcclxuXHJcbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgW0ZFSVNIVV0gRmV0Y2ggdGFibGUgZmllbGRzIGNvbXBsZXRlZCBpbiAke2VuZFRpbWUgLSBzdGFydFRpbWV9bXNgKTtcclxuXHJcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9LCBzdGF0dXNUZXh0OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgRmVpc2h1UmVzcG9uc2U8VGFibGVGaWVsZHNSZXNwb25zZT47XHJcbiAgICAgIFxyXG4gICAgICBpZiAoZGF0YS5jb2RlICE9PSAwKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IHRhYmxlIGZpZWxkczogJHtkYXRhLm1zZ31gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKCFkYXRhLmRhdGEpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGRhdGEgaW4gdGFibGUgZmllbGRzIHJlc3BvbnNlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOiuvue9rue8k+WtmFxyXG4gICAgICBjYWNoZVNlcnZpY2Uuc2V0KENBQ0hFX0tFWVMuVEFCTEVfRklFTERTLCBkYXRhLmRhdGEsIHRydWUpO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGRhdGEuZGF0YTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tGRUlTSFVdIEVycm9yIGdldHRpbmcgdGFibGUgZmllbGRzOicsIGVycm9yKTtcclxuICAgICAgLy8g5aaC5p6c6I635Y+W5paw5pWw5o2u5aSx6LSl77yM5bCd6K+V6L+U5Zue57yT5a2Y55qE5pWw5o2uXHJcbiAgICAgIGNvbnN0IGNhY2hlZEZpZWxkcyA9IGNhY2hlU2VydmljZS5nZXQ8VGFibGVGaWVsZHNSZXNwb25zZT4oQ0FDSEVfS0VZUy5UQUJMRV9GSUVMRFMsIHRydWUpO1xyXG4gICAgICBpZiAoY2FjaGVkRmllbGRzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tGRUlTSFVdIFVzaW5nIGNhY2hlZCBmaWVsZHMgYWZ0ZXIgZXJyb3InKTtcclxuICAgICAgICByZXR1cm4gY2FjaGVkRmllbGRzO1xyXG4gICAgICB9XHJcbiAgICAgIHRocm93IGVycm9yO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W6aOe5Lmm6KGo5qC86K6w5b2VXHJcbiAgICogQHJldHVybnMg6KGo5qC86K6w5b2V5YiX6KGoXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0VGFibGVSZWNvcmRzKCk6IFByb21pc2U8VGFibGVSZWNvcmRzUmVzcG9uc2U+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIOajgOafpeaYr+WQpuWPr+S7peWPkemAgeivt+axgu+8iOiKgua1geacuuWItu+8iVxyXG4gICAgICBpZiAoIXRoaXMuY2FuTWFrZVJlcXVlc3QoJ2dldFRhYmxlUmVjb3JkcycpKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tGRUlTSFVdIFNraXBwaW5nIHRhYmxlIHJlY29yZHMgcmVxdWVzdCBkdWUgdG8gcmF0ZSBsaW1pdGluZycpO1xyXG4gICAgICAgIC8vIOWmguaenOaXoOazleivt+axgu+8jOWwneivlei/lOWbnue8k+WtmOeahOiusOW9le+8jOWmguaenOayoeacieWImeaKm+WHuumUmeivr1xyXG4gICAgICAgIGNvbnN0IGNhY2hlZFJlY29yZHMgPSBjYWNoZVNlcnZpY2UuZ2V0PFRhYmxlUmVjb3Jkc1Jlc3BvbnNlPihDQUNIRV9LRVlTLlRBQkxFX1JFQ09SRFMsIHRydWUpO1xyXG4gICAgICAgIGlmIChjYWNoZWRSZWNvcmRzKSB7XHJcbiAgICAgICAgICByZXR1cm4gY2FjaGVkUmVjb3JkcztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSYXRlIGxpbWl0ZWQgYW5kIG5vIGNhY2hlZCByZWNvcmRzIGF2YWlsYWJsZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8g5bCd6K+V5LuO57yT5a2Y6I635Y+WXHJcbiAgICAgIGNvbnN0IGNhY2hlZFJlY29yZHMgPSBjYWNoZVNlcnZpY2UuZ2V0PFRhYmxlUmVjb3Jkc1Jlc3BvbnNlPihDQUNIRV9LRVlTLlRBQkxFX1JFQ09SRFMsIHRydWUpO1xyXG4gICAgICBpZiAoY2FjaGVkUmVjb3Jkcykge1xyXG4gICAgICAgIHJldHVybiBjYWNoZWRSZWNvcmRzO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IHRoaXMuZ2V0VGVuYW50QWNjZXNzVG9rZW4oKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKCdbRkVJU0hVXSBGZXRjaGluZyB0YWJsZSByZWNvcmRzLi4uJyk7XHJcbiAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxyXG4gICAgICAgIGAke0ZFSVNIVV9BUElfQkFTRV9VUkx9L2JpdGFibGUvdjEvYXBwcy8ke3RoaXMuY29uZmlnLmZlaXNodUFwcFRva2VufS90YWJsZXMvJHt0aGlzLmNvbmZpZy5mZWlzaHVUYWJsZUlkfS9yZWNvcmRzL3NlYXJjaD9wYWdlX3NpemU9NTAwYCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcclxuICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YCxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgIHZpZXdfaWQ6IHRoaXMuY29uZmlnLmZlaXNodVZpZXdJZCxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgLy8g56aB55SoTmV4dC5qc+m7mOiupOe8k+WtmFxyXG4gICAgICAgICAgY2FjaGU6ICduby1zdG9yZScsXHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG5cclxuICAgICAgY29uc3QgZW5kVGltZSA9IERhdGUubm93KCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBbRkVJU0hVXSBGZXRjaCB0YWJsZSByZWNvcmRzIGNvbXBsZXRlZCBpbiAke2VuZFRpbWUgLSBzdGFydFRpbWV9bXNgKTtcclxuXHJcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9LCBzdGF0dXNUZXh0OiAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCkgYXMgRmVpc2h1UmVzcG9uc2U8VGFibGVSZWNvcmRzUmVzcG9uc2U+O1xyXG4gICAgICBcclxuICAgICAgaWYgKGRhdGEuY29kZSAhPT0gMCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGdldCB0YWJsZSByZWNvcmRzOiAke2RhdGEubXNnfWApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoIWRhdGEuZGF0YSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gZGF0YSBpbiB0YWJsZSByZWNvcmRzIHJlc3BvbnNlJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIOiuvue9rue8k+WtmFxyXG4gICAgICBjYWNoZVNlcnZpY2Uuc2V0KENBQ0hFX0tFWVMuVEFCTEVfUkVDT1JEUywgZGF0YS5kYXRhLCB0cnVlKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiBkYXRhLmRhdGE7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdbRkVJU0hVXSBFcnJvciBnZXR0aW5nIHRhYmxlIHJlY29yZHM6JywgZXJyb3IpO1xyXG4gICAgICAvLyDlpoLmnpzojrflj5bmlrDmlbDmja7lpLHotKXvvIzlsJ3or5Xov5Tlm57nvJPlrZjnmoTmlbDmja5cclxuICAgICAgY29uc3QgY2FjaGVkUmVjb3JkcyA9IGNhY2hlU2VydmljZS5nZXQ8VGFibGVSZWNvcmRzUmVzcG9uc2U+KENBQ0hFX0tFWVMuVEFCTEVfUkVDT1JEUywgdHJ1ZSk7XHJcbiAgICAgIGlmIChjYWNoZWRSZWNvcmRzKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1tGRUlTSFVdIFVzaW5nIGNhY2hlZCByZWNvcmRzIGFmdGVyIGVycm9yJyk7XHJcbiAgICAgICAgcmV0dXJuIGNhY2hlZFJlY29yZHM7XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDmt7vliqDor7fmsYLoioLmtYHmnLrliLZcclxuICBwcml2YXRlIHJlcXVlc3RUaW1lc3RhbXBzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpO1xyXG4gIHByaXZhdGUgcmVhZG9ubHkgTUlOX1JFUVVFU1RfSU5URVJWQUwgPSA1MDAwOyAvLyDmnIDlsI/or7fmsYLpl7TpmpQ156eSXHJcblxyXG4gIC8qKlxyXG4gICAqIOajgOafpeaYr+WQpuWPr+S7peWPkemAgeivt+axgu+8iOiKgua1geacuuWItu+8iVxyXG4gICAqL1xyXG4gIHByaXZhdGUgY2FuTWFrZVJlcXVlc3Qoa2V5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICBjb25zdCBsYXN0UmVxdWVzdCA9IHRoaXMucmVxdWVzdFRpbWVzdGFtcHMuZ2V0KGtleSkgfHwgMDtcclxuICAgIGNvbnN0IGNhblJlcXVlc3QgPSBub3cgLSBsYXN0UmVxdWVzdCA+PSB0aGlzLk1JTl9SRVFVRVNUX0lOVEVSVkFMO1xyXG4gICAgXHJcbiAgICBpZiAoY2FuUmVxdWVzdCkge1xyXG4gICAgICB0aGlzLnJlcXVlc3RUaW1lc3RhbXBzLnNldChrZXksIG5vdyk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiBjYW5SZXF1ZXN0O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5omL5Yqo5Yi35paw57yT5a2YXHJcbiAgICovXHJcbiAgYXN5bmMgcmVmcmVzaENhY2hlKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc29sZS5sb2coJ1tGRUlTSFVdIFJlZnJlc2hpbmcgY2FjaGUuLi4nKTtcclxuICAgIFxyXG4gICAgLy8g5qOA5p+l5piv5ZCm5Y+v5Lul5Y+R6YCB5Yi35paw6K+35rGCXHJcbiAgICBpZiAoIXRoaXMuY2FuTWFrZVJlcXVlc3QoJ3JlZnJlc2hDYWNoZScpKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdbRkVJU0hVXSBTa2lwcGluZyByZWZyZXNoIGR1ZSB0byByYXRlIGxpbWl0aW5nJyk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8g5riF6Zmk55u45YWz57yT5a2YXHJcbiAgICBjYWNoZVNlcnZpY2UuZGVsZXRlKENBQ0hFX0tFWVMuVEFCTEVfRklFTERTKTtcclxuICAgIGNhY2hlU2VydmljZS5kZWxldGUoQ0FDSEVfS0VZUy5UQUJMRV9SRUNPUkRTKTtcclxuICAgIFxyXG4gICAgLy8g6YeN5paw6I635Y+W5pWw5o2u77yI5byC5q2l77yM5LiN562J5b6F5a6M5oiQ77yJXHJcbiAgICB0aGlzLmdldFRhYmxlRmllbGRzKCkuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoJ1tGRUlTSFVdIEZhaWxlZCB0byByZWZyZXNoIHRhYmxlIGZpZWxkczonLCBlcnIpKTtcclxuICAgIHRoaXMuZ2V0VGFibGVSZWNvcmRzKCkuY2F0Y2goZXJyID0+IGNvbnNvbGUuZXJyb3IoJ1tGRUlTSFVdIEZhaWxlZCB0byByZWZyZXNoIHRhYmxlIHJlY29yZHM6JywgZXJyKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyDlr7zlh7rljZXkvovlrp7kvotcclxuZXhwb3J0IGNvbnN0IGZlaXNodVNlcnZpY2UgPSBuZXcgRmVpc2h1U2VydmljZSgpOyJdLCJuYW1lcyI6WyJjYWNoZVNlcnZpY2UiLCJGRUlTSFVfQVBJX0JBU0VfVVJMIiwiQ0FDSEVfS0VZUyIsIlRFTkFOVF9BQ0NFU1NfVE9LRU4iLCJUQUJMRV9GSUVMRFMiLCJUQUJMRV9SRUNPUkRTIiwiZ2V0QXBwQ29uZmlnIiwiZmVpc2h1QXBwSWQiLCJwcm9jZXNzIiwiZW52IiwiRkVJU0hVX0FQUF9JRCIsImZlaXNodUFwcFNlY3JldCIsIkZFSVNIVV9BUFBfU0VDUkVUIiwiZmVpc2h1QXBwVG9rZW4iLCJGRUlTSFVfQVBQX1RPS0VOIiwiZmVpc2h1VGFibGVJZCIsIkZFSVNIVV9UQUJMRV9JRCIsImZlaXNodVZpZXdJZCIsIkZFSVNIVV9WSUVXX0lEIiwic3VibWl0VXJsIiwiTkVYVF9QVUJMSUNfU1VCTUlUX1VSTCIsIkZlaXNodVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsInJlcXVlc3RUaW1lc3RhbXBzIiwiTWFwIiwiTUlOX1JFUVVFU1RfSU5URVJWQUwiLCJjb25maWciLCJnZXRUZW5hbnRBY2Nlc3NUb2tlbiIsImNhbk1ha2VSZXF1ZXN0IiwiY29uc29sZSIsImxvZyIsImNhY2hlZFRva2VuIiwiZ2V0IiwiRXJyb3IiLCJzdGFydFRpbWUiLCJEYXRlIiwibm93IiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFwcF9pZCIsImFwcF9zZWNyZXQiLCJlbmRUaW1lIiwib2siLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwicmVzcG9uc2VUZXh0IiwidGV4dCIsImRhdGEiLCJwYXJzZSIsImNvZGUiLCJtc2ciLCJ0b2tlbkRhdGEiLCJ0ZW5hbnRfYWNjZXNzX3Rva2VuIiwidG9rZW4iLCJleHBpcmVJblNlY29uZHMiLCJNYXRoIiwibWF4IiwiZXhwaXJlIiwic2V0IiwiZXJyb3IiLCJnZXRUYWJsZUZpZWxkcyIsImNhY2hlZEZpZWxkcyIsImNhY2hlIiwianNvbiIsImdldFRhYmxlUmVjb3JkcyIsImNhY2hlZFJlY29yZHMiLCJ2aWV3X2lkIiwia2V5IiwibGFzdFJlcXVlc3QiLCJjYW5SZXF1ZXN0IiwicmVmcmVzaENhY2hlIiwiZGVsZXRlIiwiY2F0Y2giLCJlcnIiLCJmZWlzaHVTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/services/feishu.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ffeishu%2Fdata%2Froute&page=%2Fapi%2Ffeishu%2Fdata%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ffeishu%2Fdata%2Froute.ts&appDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5C123%5CDesktop%5Chongfu&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();